services:
  cleanuperr:
    image: ghcr.io/flmorg/cleanuperr:latest
    container_name: cleanuperr
    restart: unless-stopped
    volumes:
      - {{ ansible_user_dir }}/appdata/cleanuperr/logs:/var/logs
      - /mnt/torrents:/downloads
    environment:
      - TZ={{ service.timezone | default("America/New_York") }}
      - DRY_RUN=false
      - HTTP_MAX_RETRIES=0
      - HTTP_TIMEOUT=100
      - HTTP_VALIDATE_CERT=Enabled
      
      - LOGGING__LOGLEVEL=Information
      - LOGGING__FILE__ENABLED=false
      - LOGGING__FILE__PATH=/var/logs/
      - LOGGING__ENHANCED=true
      
      - SEARCH_ENABLED=true
      - SEARCH_DELAY=30
      
      - TRIGGERS__QUEUECLEANER=0 0/5 * * * ?
      - QUEUECLEANER__ENABLED=true
      - QUEUECLEANER__IGNORED_DOWNLOADS_PATH=/ignored.txt
      - QUEUECLEANER__RUNSEQUENTIALLY=true
      
      - QUEUECLEANER__IMPORT_FAILED_MAX_STRIKES=5
      - QUEUECLEANER__IMPORT_FAILED_IGNORE_PRIVATE=false
      - QUEUECLEANER__IMPORT_FAILED_DELETE_PRIVATE=false
      - QUEUECLEANER__IMPORT_FAILED_IGNORE_PATTERNS__0=title mismatch
      - QUEUECLEANER__IMPORT_FAILED_IGNORE_PATTERNS__1=manual import required
      
      - QUEUECLEANER__STALLED_MAX_STRIKES=5
      - QUEUECLEANER__STALLED_RESET_STRIKES_ON_PROGRESS=true
      - QUEUECLEANER__STALLED_IGNORE_PRIVATE=false
      - QUEUECLEANER__STALLED_DELETE_PRIVATE=false
      - QUEUECLEANER__DOWNLOADING_METADATA_MAX_STRIKES=5
      
      - QUEUECLEANER__SLOW_MAX_STRIKES=5
      - QUEUECLEANER__SLOW_RESET_STRIKES_ON_PROGRESS=true
      - QUEUECLEANER__SLOW_IGNORE_PRIVATE=false
      - QUEUECLEANER__SLOW_DELETE_PRIVATE=false
      - QUEUECLEANER__SLOW_MIN_SPEED=1MB
      - QUEUECLEANER__SLOW_MAX_TIME=20
      - QUEUECLEANER__SLOW_IGNORE_ABOVE_SIZE=60GB
      
      - TRIGGERS__CONTENTBLOCKER=0 0/5 * * * ?
      - CONTENTBLOCKER__ENABLED=true
      - CONTENTBLOCKER__IGNORED_DOWNLOADS_PATH=/ignored.txt
      - CONTENTBLOCKER__IGNORE_PRIVATE=false
      - CONTENTBLOCKER__DELETE_PRIVATE=false
      
      - TRIGGERS__DOWNLOADCLEANER=0 0 * * * ?
      - DOWNLOADCLEANER__ENABLED=true
      - DOWNLOADCLEANER__IGNORED_DOWNLOADS_PATH=/ignored.txt
      - DOWNLOADCLEANER__DELETE_PRIVATE=false
      
      - DOWNLOADCLEANER__CATEGORIES__0__NAME=tv-sonarr
      - DOWNLOADCLEANER__CATEGORIES__0__MAX_RATIO=1
      - DOWNLOADCLEANER__CATEGORIES__0__MIN_SEED_TIME=0
      - DOWNLOADCLEANER__CATEGORIES__0__MAX_SEED_TIME=240
      - DOWNLOADCLEANER__CATEGORIES__1__NAME=radarr
      - DOWNLOADCLEANER__CATEGORIES__1__MAX_RATIO=1
      - DOWNLOADCLEANER__CATEGORIES__1__MIN_SEED_TIME=0
      - DOWNLOADCLEANER__CATEGORIES__1__MAX_SEED_TIME=240
      - DOWNLOADCLEANER__CATEGORIES__2__NAME=cleanuperr-unlinked
      - DOWNLOADCLEANER__CATEGORIES__2__MAX_RATIO=1
      - DOWNLOADCLEANER__CATEGORIES__2__MIN_SEED_TIME=0
      - DOWNLOADCLEANER__CATEGORIES__2__MAX_SEED_TIME=240
      
      - DOWNLOADCLEANER__UNLINKED_TARGET_CATEGORY=cleanuperr-unlinked
      - DOWNLOADCLEANER__UNLINKED_USE_TAG=false
      - DOWNLOADCLEANER__UNLINKED_IGNORED_ROOT_DIR=/downloads
      - DOWNLOADCLEANER__UNLINKED_CATEGORIES__0=tv-sonarr
      - DOWNLOADCLEANER__UNLINKED_CATEGORIES__1=radarr
      
      #- DOWNLOAD_CLIENT=none
      # OR
      # - DOWNLOAD_CLIENT=disabled
      # OR          
      - DOWNLOAD_CLIENT=qBittorrent
      - QBITTORRENT__URL=http://10.11.30.2:8080
      # - QBITTORRENT__URL_BASE=myCustomPath
      - QBITTORRENT__USERNAME=mcd123651
      - QBITTORRENT__PASSWORD=123651
      # OR
      # - DOWNLOAD_CLIENT=deluge
      # - DELUGE__URL=http://localhost:8112
      # - DELUGE__URL_BASE=myCustomPath
      # - DELUGE__PASSWORD=pass
      # OR
      # - DOWNLOAD_CLIENT=transmission
      # - TRANSMISSION__URL=http://localhost:9091
      # - TRANSMISSION__URL_BASE=myCustomPath
      # - TRANSMISSION__USERNAME=user
      # - TRANSMISSION__PASSWORD=pass
      
      - SONARR__ENABLED=true
      - SONARR__IMPORT_FAILED_MAX_STRIKES=-1
      - SONARR__SEARCHTYPE=Episode
      # - SONARR__BLOCK__TYPE=blacklist
      # - SONARR__BLOCK__PATH=https://example.com/path/to/file.txt
      - SONARR__INSTANCES__0__URL=http://sonarr:8989
      - SONARR__INSTANCES__0__APIKEY=351eb61442134cb19b4b0ae7477e6e25
      #- SONARR__INSTANCES__1__URL=http://sonarr:8990
      #- SONARR__INSTANCES__1__APIKEY=sonarrSecret2
      
      - RADARR__ENABLED=true
      - RADARR__IMPORT_FAILED_MAX_STRIKES=-1
      # - RADARR__BLOCK__TYPE=blacklist
      # - RADARR__BLOCK__PATH=https://example.com/path/to/file.txt
      - RADARR__INSTANCES__0__URL=http://radarr:7878
      - RADARR__INSTANCES__0__APIKEY=0699881fdd144b7fa180b10a9b4aa7f9
      #- RADARR__INSTANCES__1__URL=http://localhost:7879
      #- RADARR__INSTANCES__1__APIKEY=radarrSecret2
      
      #- LIDARR__ENABLED=true
      #- LIDARR__IMPORT_FAILED_MAX_STRIKES=-1
      #- LIDARR__BLOCK__TYPE=blacklist
      #- LIDARR__BLOCK__PATH=https://example.com/path/to/file.txt
      #- LIDARR__INSTANCES__0__URL=http://localhost:8686
      #- LIDARR__INSTANCES__0__APIKEY=lidarrSecret1
      #- LIDARR__INSTANCES__1__URL=http://localhost:8687
      #- LIDARR__INSTANCES__1__APIKEY=lidarrSecret2
      
      #- NOTIFIARR__ON_IMPORT_FAILED_STRIKE=true
      #- NOTIFIARR__ON_STALLED_STRIKE=true
      #- NOTIFIARR__ON_SLOW_STRIKE=true
      #- NOTIFIARR__ON_QUEUE_ITEM_DELETED=true
      #- NOTIFIARR__ON_DOWNLOAD_CLEANED=true
      #- NOTIFIARR__ON_CATEGORY_CHANGED=true
      #- NOTIFIARR__API_KEY=notifiarrSecret
      #- NOTIFIARR__CHANNEL_ID=discordChannelId
      
      #- APPRISE__ON_IMPORT_FAILED_STRIKE=true
      #- APPRISE__ON_STALLED_STRIKE=true
      #- APPRISE__ON_SLOW_STRIKE=true
      #- APPRISE__ON_QUEUE_ITEM_DELETED=true
      #- APPRISE__ON_DOWNLOAD_CLEANED=true
      #- APPRISE__ON_CATEGORY_CHANGED=true
      #- APPRISE__URL=http://apprise:8000
      #- APPRISE__KEY=myConfigKey
    networks:
      - arr-net
  
networks:
  arr-net:
    name: arr-net
    external: True